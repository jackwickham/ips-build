![build-test](https://github.com/jackwickham/ips-plugin-build/workflows/build-test/badge.svg)

# IPS Builder

A GitHub action to build IPS plugins and themes into XML files.

## Usage

In `.github/workflows/yourworkflow.yml`, make sure that the checkout step sets
the fetch depth to `0`, which means that it fetches all commits and tags:
```yaml
- uses: actions/checkout@v2
  with:
    fetch-depth: 0
```
Then add another step:
```yaml
- uses: jackwickham/ips-build@v1
  with:
    name: Your plugin name # Required
    author: Your name # Optional
    website: Your website or the plugin's website # Optional
    path: /path/to/plugin # Optional, defaults to $GITHUB_WORKSPACE
```

Configure the workflow to run on tag, or on push and tag.

The human readable version number is generated by running `git describe` and
trimming any leading `v`. This means that release versions should be tagged with
a human-readable version number (maybe with leading `v`), and builds that aren't
on a tag will have the human readable version number of
last_tag+commits_since-gcommit_hash, such as `1.2.3+5-g123456ab`. The long
version is computed from this version, assigning two digits to each of the
major, minor, fix and offset components, such as `1020305`.

For builds on tags, the version computed by this tool must match the version in
`versions.json`, and the build will be failed if this is not the case.

If you have a `install.php` file in your plugin, you must release a version with
long version of `10000`, either by releasing manually or by tagging with 0.1.0.

## Contributing

Prior to committing, run `npm run all` and commit the result, to ensure that all
lint issues are fixed and the compiled result is checked in.
